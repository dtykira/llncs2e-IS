\section{Experiments\label{sec:experiment}}

\subsection{Experiments on Searching for Iterative Trails}

We apply our method in Section \ref{subsec:iterative-trails} to PRESENT, GIFT-64, RECTANGLE, 256-bit KNOT permutation and ASCON permutation. The results on iterative trails are shown in Table \ref{tab:iterative-trails}. The visualizations of $G^{IT}_{F,max\_asn}$ are shown in Appendix \ref{app:visualization}.

%The iterative structures are illustrated in Figures \ref{fig:graph_knot256_ddt}-\ref{fig:graph_gift_lat} in Appendix \ref{sec:is}. The differential and linear iterative structures of PRESENT are too big to be illustrated. The quantitive summary results are illustrated in Table \ref{tab:is}. For PRESENT, we constrain the elementary differential iterative trails within 10 rounds, for the genuine iterative structure is too complicated.

\begin{table}
	\caption{Results on iterative trails}\label{tab:iterative-trails}
	\centering
	\tiny
	\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|}
		\hline
		cryptanalysis & cipher ($F$) & rs. & $max\_asn$ &$|V_{F,max\_asn}|$&$\leq n$& $|V^{IT}_{F,max\_asn}|$ & \#ecs. & best w/l. &time\\
		\hline
		\multirow{5}{*}{differential (Prob.)}
		&KNOT-perm-256 & yes & 2 & 8214 & - & 5 & 6 & 5.3 & 0.3s\\
		\cline{2-10}
		&PRESENT & no & 2 & 17256 & 10 & 225 & 463 & 4.5 & 2.1s\\
		\cline{2-10}
		&GIFT-64 & no & 2 & 19344 & - & 32 & 66 & 5 & 1.8s\\
		\cline{2-10}
		& RECTANGLE & yes & 2 & 1450 & - & 6 & 3 & 5 & 0.1s\\
		\cline{2-10}
		& ASCON-perm & yes & 3 & 3939 & - & 0 & 0 & - & 2.7h\\
		\hline
		\multirow{4}{*}{linear (Cor.)}
		& KNOT-perm-256 & yes & 2 & 8229 & - & 8 & 10 & 3 & 0.4s\\
		\cline{2-10}
		& PRESENT & no & 1 & 208 & - & 27 & 114223 & 2 & 3.6s\\
		\cline{2-10}
		& GIFT-64 & no & 2 & 21696 & - & 16 & 4 & 3 & 2.3s\\
		\cline{2-10}
		& RECTANGLE & yes & 2 & 1465 & - & 10 & 16 & 3 & 0.1s\\
		\cline{2-10}
		& ASCON-perm & yes & 3 & 336 & - & 0 & 0 & - & 4.0h\\
		\hline
		\multicolumn{9}{l}{rs.: whether the cipher has the property of rotational symmetry}\\
		\multicolumn{9}{l}{$\leq n$: the length of any elementary circuit is restricted to no more than $n$}\\
		\multicolumn{9}{l}{\#ecs.: number of elementary circuits}\\
		\multicolumn{9}{l}{best w/l.: the smallest weight/length that an elementary circuit can has}\\
	\end{tabular}
\end{table}

We consider the smallest weight per length an elementary iterative trail can has (best w/l. in Table \ref{tab:iterative-trails}) as an index describing the growth of iterative differential and linear propagations. We can see that PRESENT has both the weakest growth of iterative differential and linear propagations. The weakest differential iterative trail is exactly the one found by Wang et al.\cite{W08}. 

%256-bit KNOT permutation, PRESENT, GIFT-64 and RECTANGLE share a common point that each of them uses a bit permutation as its linear layer which is hardware-friendly and an S-box also providing diffusion as its non-linear layer. However, due to the weakness of the linear layer, the best differential and linear weights of them all increase proportionally with the round number, because of the existence of iterative trails. Meanwhile ASCON permutation uses a low-latency S-box and a strong linear layer. From Table \ref{tab:is} we can see that the differential iterative structure of ASCON permutation is empty even when $k=3$.

%A question is raised that how far a cipher with a comparatively weak diffusion layer can go. As long as the iterative structure is not empty, the best weight increases proportionally with the round number. Through the visualization of iterative structure, we hope to inform symmetric-key primitive designers of the detailed structure of iterative trails. 

%\subsection{Results of the Best Weights}
%
%Results for 256-bit KNOT permutation, PRESENT, GIFT-64 and RECTANGLE on the best weights obtained using our methods in section \ref{sec:para2} and \ref{sec:para3} are illustrated in Tables \ref{tab:knot256}-\ref{tab:rect}. They are compared with the weights of the best differential and linear trails. Using the method proposed in section \ref{sec:para2}, we need to determine the parameters $(r^f,r^b)$ first. Using the method proposed in section \ref{sec:para3}, we need to determine the parameters $(r^f,w^f,r^b,w^b,gap)$ first, where $gap=wub-bw[r]$ when searching $r$-round clusters. The larger each parameter is, the more time is consumed and the more accurate the result is. 
%
%The results obtained by our method coincide with the results of genuine best weight when the round number is large, except for results of linear weights for GIFT-64. The best 13-round linear trail of GIFT given in \cite{ZZDX19} has correlation $2^{-34}$ and has no iterative trail in it. Our method is unable to find such a trail. 
%
%%Our method finishes in minutes or even in seconds and is able to obtain an upper bound of the best weight for ciphers have iterative trails.

\subsection{Experiments on Finding Differential Trails and Linear Trails}

We apply our method in Section \ref{subsec:find-trails} and \ref{subsec:find-clusters} to PRESENT, GIFT-64, RECTANGLE and 256-bit KNOT permutation. The algorithm is run on an Intel Core i7-6700 CPU at 3.40GHz with 16GB RAM. The results for differential cryptanalysis are shown in Table \ref{tab:EDP}. The results for linear cryptanalysis are shown in Table \ref{tab:ELP}. Results for PRESENT, RECTANGLE and GIFT-64 are not better than but close to results in \cite{HV18}, which implies that iterative trails dominate the good differentials and linear hulls of these ciphers. However our method costs much less time. The 256-bit KNOT permutation is used in NIST LWC round 2 candidate KNOT \cite{ZDY19}, which is a inheritor of RECTANGLE having a larger number of rounds and a larger block size. For the 256-bit KNOT permutation, we are able to find good differentials up to 52 rounds and good linear hulls up to 51 rounds. 

\begin{table}
	\caption{Results for differential cryptanalysis}\label{tab:EDP}
	\centering
	\begin{tabular}{|c|c|c|c|c|c|c|c|}
		\hline
		cipher & rounds & $r^F,r^{F^{-1}}$ & $\Prob$ & Time & $r^F,w^F,r^{F^{-1}},w^{F^{-1}}$ & EDP & Time \\
		\hline
		PRESENT & 14 & 3,3 & 62 & $<$1s & 3,13,3,13 & 54.9879 & 425.15s \\
		\hline 
		PRESENT & 17 & - & - & - & 3,13,3,13 & 62.6897 & 498.513s\\
		\hline 
		RECTANGLE & 13 & 6,6 & 56 & 1.2s & 6,25,6,25 & 55.6601 & 12007.5s \\
		\hline
		GIFT-64 & 13 & 3,3 & 62 & $<$1s & 3,13,3,13 & 60.415 & 32.365s\\
		\hline
		KNOT-perm-256 & 48 & 3,3 & 252 & $<$1s & 3,13,3,13 & 232.591 & 19.536s\\
		\hline
		KNOT-perm-256 & 52 & 3,3 & 274 & $<$1s & 3,13,3,13 & 251.831 & 20.407s\\
		\hline
	\end{tabular}
\end{table}

\begin{table}
	\caption{Results for linear cryptanalysis}\label{tab:ELP}
	\centering
	\begin{tabular}{|c|c|c|c|c|c|c|c|}
		\hline
		cipher & rounds & $r^F,r^{F^{-1}}$ & $\Cor^2$ & Time & $r^F,w^F,r^{F^{-1}},w^{F^{-1}}$ & ELP & Time \\
		\hline
		PRESENT & 17 & 3,3 & 64 & $<$1s & 3,8,3,8 & 45.6582 & $<$1s\\
		\hline 
		PRESENT & 23 & 3,3 & 92 & $<$1s & 3,8,3,8 & 61.1404 & $<$1s\\
		\hline 
		PRESENT & 24 & 3,3 & 96 & $<$1s & 3,8,3,8 & 63.7519 & $<$1s\\
		\hline 
		RECTANGLE & 13 & 5,5 & 62 & $<$1s & 5,20,5,20 & 59.6377 & 337.195s \\
		\hline
		RECTANGLE & 13 & - & - & - & 6,25,6,25 & 59.3095 & 7565.67s \\
		\hline
		GIFT-64 & 12 & 3,3 & 64 & $<$1s& 3,13,3,13 & 64 & $<$1s \\
		\hline
		KNOT-perm-256 & 45 & 3,3 & 256 & $<$1s & 3,7,3,7 & 222 & 100.892s\\
		KNOT-perm-256 & 51 & 3,3 & 292 & $<$1s & 3,7,3,7 & 252 & 111.763s\\
		KNOT-perm-256 & 51 & - & - & - & 3,9,3,9 & 251.356 & 4642.19s\\
		\hline
	\end{tabular}
\end{table}

\subsection{Experiment on KNOT}

KNOT is a family of lightweight authenticated encryption algorithms and hash functions \cite{ZDY19}. The modes of operation of KNOT for AE and hash are shown in Figure . The modes are similar to the ones used in Ketje and ASCON. The inner permutations are inheritors of RECTANGLE, which are bit-sliced lightweight. The round transformation has 3 steps: 4-bit S-boxes, row rotations and a constant addition. 

The differential and linear distinguishers with no restrictions can not be directly uesd to attack the duplex construction. In the following, we propose a few differential and linear attacks, each demanding specific restrictions on the distinguishers, on the primary version of KNOT which uses the 256-bit KNOT permutation.

\subsubsection{Attack Model 1}
This is a chosen-nonce differential distinguishing attack targeting the initialization phase of KNOT-AEAD. The input difference has the nonce part and key part $\Delta SI=(\Delta SI_N,\Delta SI_K)$. The output difference has the rate part and capacity part $\Delta SO=(\Delta SO_R,\Delta SO_C)$. We restrict that $\Delta SI_K=0$. And $\Delta SO_C$ is truncated.  

\subsubsection{Attack Model 2}
This is a known-nonce and known-plaintext linear key recovery attack targeting the initialization phase of KNOT-AEAD. The input mask $\Gamma SI=(\Gamma SI_N,\Gamma SI_K)$ and the output mask $\Gamma SO=(\Gamma SO_R,\Gamma SO_C)$. We restrict that $\Gamma SO_C=0$. Note that if $\Gamma SI_K\neq 0$, the attack degrades to a distinguishing one. 

\subsubsection{Attack Model 3}
This is a known-nonce and known-plaintext linear distinguishing attack targeting the initialization phase of KNOT-AEAD in multi-key setting. The input mask $\Gamma SI=(\Gamma SI_N,\Gamma SI_K)$ and the output mask $\Gamma SO=(\Gamma SO_R,\Gamma SO_C)$. We restrict that $\Gamma SO_C=0$ and $\Gamma SI_K=0$.

\subsubsection{Attack Model 4}
This is a known-plaintext linear distinguishing attack targeting the encryption phase of KNOT-AEAD. The input mask $\Gamma SI=(\Gamma SI_R,\Gamma SI_C)$ and the output mask $\Gamma SO=(\Gamma SO_R,\Gamma SO_C)$. We restrict that $\Gamma SI_C=0$ and $\Gamma SO_C=0$. 

\subsubsection{Attack Model 5}
This is a differential forgery attack targeting the finalization phase of KNOT-AEAD. The input difference $\Delta SI=(\Delta SI_R,\Delta SI_C)$ and the output difference $\Delta SO=(\Delta SO_T,\Delta SO_nT)$. We restrictions that $\Delta SI_C=0$. And $\Delta SO_nT$ is truncated. 

\subsubsection{Attack Model 6}
This is a differential collsion attack targeting the absorb phase of KNOT-Hash. The input difference $\Delta SI=(\Delta SI_R,\Delta SI_C)$ and the output difference $\Delta SO=(\Delta SO_R,\Delta SO_C)$. We restrictions that $\Delta SI_C=0$ and $\Delta SO_C=0$. 

\subsubsection{Attack Model 7}
This is a differential collsion attack targeting the squeezing phase of KNOT-Hash. The input difference $\Delta SI=(\Delta SI_R,\Delta SI_C)$ and the output difference $\Delta SO=(\Delta SO_{R'},\Delta SO_{C'})$. We restrictions that $\Delta SI_C=0$ and $\Delta SI_{R'}=0$. And $\Delta SI_{C'}$ is truncated. 

\begin{table}
	\caption{Results for KNOT}\label{tab:knot}
	\centering
	\begin{tabular}{|c|c|c|c|c|c|c|c|}
		\hline
		Attack Model & rounds & $r^F,w^F,r^{F^{-1}},w^{F^{-1}}$ & EDP or ELP & Time & Security Claim\\
		\hline
		AM1 & 27 & 5,20,5,20 & 124.5 & & 125 \\
		AM2 & 24 & 3,8,3,8 & 120 & & 125 \\
		AM3 & 24 & 3,8,3,8 & 122 & & 125 \\
		AM4 & 24 & 3,10,3,10 & 124 & & 125 \\
		AM5 & 26 & 5,20,5,20 & 123.7 & & 125 \\
		AM6 & 21 & 5,20,5,20 & 107.0 & & 112 \\
		AM7 & 23 & 5,20,5,20 & 109.0 & & 112 \\
		\hline
	\end{tabular}
\end{table}