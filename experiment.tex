\section{Experiments\label{sec:experiment}}

\subsection{Experiments on Searching for Iterative Trails}

We apply our method in Section \ref{subsec:iterative-trails} to PRESENT, GIFT-64, RECTANGLE, 256-bit KNOT permutation and ASCON permutation. The results on iterative trails are shown in Table \ref{tab:iterative-trails}. The visualizations of $G^{IT}_{F,max\_asn}$ are shown in Appendix \ref{app:visualization}.

%The iterative structures are illustrated in Figures \ref{fig:graph_knot256_ddt}-\ref{fig:graph_gift_lat} in Appendix \ref{sec:is}. The differential and linear iterative structures of PRESENT are too big to be illustrated. The quantitive summary results are illustrated in Table \ref{tab:is}. For PRESENT, we constrain the elementary differential iterative trails within 10 rounds, for the genuine iterative structure is too complicated.

\begin{table}
	\caption{Results on iterative trails}\label{tab:iterative-trails}
	\centering
	\tiny
	\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|}
		\hline
		cryptanalysis & cipher ($F$) & rs. & $max\_asn$ &$|V_{F,max\_asn}|$&$\leq n$& $|V^{IT}_{F,max\_asn}|$ & \#ecs. & best w/l. &time\\
		\hline
		\multirow{5}{*}{differential (Prob.)}
		&KNOT-perm-256 & yes & 2 & 8214 & - & 5 & 6 & 5.3 & 0.3s\\
		\cline{2-10}
		&PRESENT & no & 2 & 17256 & 10 & 225 & 463 & 4.5 & 2.1s\\
		\cline{2-10}
		&GIFT-64 & no & 2 & 19344 & - & 32 & 66 & 5 & 1.8s\\
		\cline{2-10}
		& RECTANGLE & yes & 2 & 1450 & - & 6 & 3 & 5 & 0.1s\\
		\cline{2-10}
		& ASCON-perm & yes & 3 & 3939 & - & 0 & 0 & - & 2.7h\\
		\hline
		\multirow{4}{*}{linear (Cor.)}
		& KNOT-perm-256 & yes & 2 & 8229 & - & 8 & 10 & 3 & 0.4s\\
		\cline{2-10}
		& PRESENT & no & 1 & 208 & - & 27 & 114223 & 2 & 3.6s\\
		\cline{2-10}
		& GIFT-64 & no & 2 & 21696 & - & 16 & 4 & 3 & 2.3s\\
		\cline{2-10}
		& RECTANGLE & yes & 2 & 1465 & - & 10 & 16 & 3 & 0.1s\\
		\cline{2-10}
		& ASCON-perm & yes & 3 & 336 & - & 0 & 0 & - & 4.0h\\
		\hline
		\multicolumn{9}{l}{rs.: whether the cipher has the property of rotational symmetry}\\
		\multicolumn{9}{l}{$\leq n$: the length of any elementary circuit is restricted to no more than $n$}\\
		\multicolumn{9}{l}{\#ecs.: number of elementary circuits}\\
		\multicolumn{9}{l}{best w/l.: the smallest weight/length that an elementary circuit can has}\\
	\end{tabular}
\end{table}

We consider the smallest weight per length an elementary iterative trail can has (best w/l. in Table \ref{tab:iterative-trails}) as an index describing the growth of iterative differential and linear propagations. We can see that PRESENT has both the weakest growth of iterative differential and linear propagations. The weakest differential iterative trail is exactly the one found by Wang et al.\cite{W08}. 

%256-bit KNOT permutation, PRESENT, GIFT-64 and RECTANGLE share a common point that each of them uses a bit permutation as its linear layer which is hardware-friendly and an S-box also providing diffusion as its non-linear layer. However, due to the weakness of the linear layer, the best differential and linear weights of them all increase proportionally with the round number, because of the existence of iterative trails. Meanwhile ASCON permutation uses a low-latency S-box and a strong linear layer. From Table \ref{tab:is} we can see that the differential iterative structure of ASCON permutation is empty even when $k=3$.

%A question is raised that how far a cipher with a comparatively weak diffusion layer can go. As long as the iterative structure is not empty, the best weight increases proportionally with the round number. Through the visualization of iterative structure, we hope to inform symmetric-key primitive designers of the detailed structure of iterative trails. 

%\subsection{Results of the Best Weights}
%
%Results for 256-bit KNOT permutation, PRESENT, GIFT-64 and RECTANGLE on the best weights obtained using our methods in section \ref{sec:para2} and \ref{sec:para3} are illustrated in Tables \ref{tab:knot256}-\ref{tab:rect}. They are compared with the weights of the best differential and linear trails. Using the method proposed in section \ref{sec:para2}, we need to determine the parameters $(r^f,r^b)$ first. Using the method proposed in section \ref{sec:para3}, we need to determine the parameters $(r^f,w^f,r^b,w^b,gap)$ first, where $gap=wub-bw[r]$ when searching $r$-round clusters. The larger each parameter is, the more time is consumed and the more accurate the result is. 
%
%The results obtained by our method coincide with the results of genuine best weight when the round number is large, except for results of linear weights for GIFT-64. The best 13-round linear trail of GIFT given in \cite{ZZDX19} has correlation $2^{-34}$ and has no iterative trail in it. Our method is unable to find such a trail. 
%
%%Our method finishes in minutes or even in seconds and is able to obtain an upper bound of the best weight for ciphers have iterative trails.

\subsection{Experiments on Finding Differential Trails and Linear Trails}

We apply our method in Section \ref{subsec:find-trails} and \ref{subsec:find-clusters} to PRESENT, GIFT-64, RECTANGLE and 256-bit KNOT permutation. The algorithm is run on an Intel Core i7-6700 CPU at 3.40GHz with 16GB RAM. The results for differential cryptanalysis are shown in Table \ref{tab:EDP}. The results for linear cryptanalysis are shown in Table \ref{tab:ELP}. 

\begin{table}
	\caption{Results for differential cryptanalysis}\label{tab:EDP}
	\centering
	\begin{tabular}{|c|c|c|c|c|c|c|}
		\hline
		cipher & rounds & EDP1 & Time & EDP2 & Time \\
		\hline
		PRESENT & \\
		\hline 
		RECTANGLE & 13 & 56 & 1.2s & 55.6601 & 12007.5s \\
		\hline
		GIFT-64 \\
		\hline
		KNOT-perm-256 \\
		\hline
	\end{tabular}
\end{table}

\begin{table}
	\caption{Results for linear cryptanalysis}\label{tab:ELP}
	\centering
	\begin{tabular}{|c|c|c|c|c|c|c|}
		\hline
		cipher & rounds & ELP1 & Time & ELP2 & Time \\
		\hline
		PRESENT & \\
		\hline 
		RECTANGLE & 13 & 62 & 0.2s & 59.6377 & 337.195s \\
		\hline
		GIFT-64 \\
		\hline
		KNOT-perm-256 \\
		\hline
	\end{tabular}
\end{table}

\subsection{Experiment on KNOT}

\subsubsection{Attack Model 1}

